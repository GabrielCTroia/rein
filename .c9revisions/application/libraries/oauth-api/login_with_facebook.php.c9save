{"ts":1357412151216,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"<?php\n/*\n * login_with_facebook.php\n *\n * @(#) $Id: login_with_facebook.php,v 1.2 2012/10/05 09:22:40 mlemos Exp $\n *\n */\n\n\trequire('http.php');\n\trequire('oauth_client.php');\n\n\t$client = new oauth_client_class;\n\t$client->server = 'Facebook';\n\t$client->redirect_uri = 'http://'.$_SERVER['HTTP_HOST'].\n\t\tdirname(strtok($_SERVER['REQUEST_URI'],'?')).'/login_with_facebook.php';\n\n\t$client->client_id = ''; $application_line = __LINE__;\n\t$client->client_secret = '';\n\n\tif(strlen($client->client_id) == 0\n\t|| strlen($client->client_secret) == 0)\n\t\tdie('Please go to Facebook Apps page https://developers.facebook.com/apps , '.\n\t\t\t'create an application, and in the line '.$application_line.\n\t\t\t' set the client_id to App ID/API Key and client_secret with App Secret');\n\n\t/* API permissions\n\t */\n\t$client->scope = 'email';\n\tif(($success = $client->Initialize()))\n\t{\n\t\tif(($success = $client->Process()))\n\t\t{\n\t\t\tif(strlen($client->access_token))\n\t\t\t{\n\t\t\t\t$success = $client->CallAPI(\n\t\t\t\t\t'https://graph.facebook.com/me', \n\t\t\t\t\t'GET', array(), array('FailOnAccessError'=>true), $user);\n\t\t\t}\n\t\t}\n\t\t$success = $client->Finalize($success);\n\t}\n\tif($client->exit)\n\t\texit;\n\tif($success)\n\t{\n?>\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\">\n<html>\n<head>\n<title>Facebook OAuth client results</title>\n</head>\n<body>\n<?php\n\t\techo '<h1>', HtmlSpecialChars($user->name), \n\t\t\t' you have logged in successfully with Facebook!</h1>';\n\t\techo '<pre>', HtmlSpecialChars(print_r($user, 1)), '</pre>';\n?>\n</body>\n</html>\n<?php\n\t}\n\telse\n\t{\n?>\n<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\">\n<html>\n<head>\n<title>OAuth client error</title>\n</head>\n<body>\n<h1>OAuth client error</h1>\n<pre>Error: <?php echo HtmlSpecialChars($client->error); ?></pre>\n</body>\n</html>\n<?php\n\t}\n\n?>"]],"start1":0,"start2":0,"length1":0,"length2":1781}]],"length":1781}
